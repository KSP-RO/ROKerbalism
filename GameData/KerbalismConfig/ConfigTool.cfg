@PART:HAS[@ROKConfigTool]:LAST
{
	//	##############################
	//	Values that can be set:
	//	##############################
	//	Scrubber = LiOH, KO2, Vacuum
	//	LOXGOX = True - Oxygen provided by LOX to GOX converter
	//	FUELCELL = True - Water provided by Fuel cells
	//	AppendDescription = True - Adds "Supports X crew for Y days." to description

	// Default consumption rates and values
	// Rates per kerbal-day
	@ROKConfigTool
	{
		&Crew = #$/CrewCapacity$
		&Days = 0
		Volume = 0
		Food = 5.84928
		Oxygen = 591.84
		Water = 3.87072
		Waste = 0
	}

	@ROKConfigTool:HAS[#Scrubber[LiOH]]
	{
		LiOH = 
		LiOH *= #$Crew$
		LiOH *= #$Days$
		Volume += #$LiOH$

		LiOHWaste = 
		LiOHWaste *= #$Crew$
		LiOHWaste *= #$Days$
		Waste += #$LiOHWaste$
	}

	@ROKConfigTool:HAS[#Scrubber[KO2]]
	{
		KO2 = 
		KO2 *= #$Crew$
		KO2 *= #$Days$
		Volume += #$KO2$

		KO2Waste = 
		KO2Waste = #$Crew$
		KO2Waste = #$Days$
		Waste += #$KO2Waste$
		// Some oxygen returned, reduce effective oxygen consumption
		Oxygen *= 
	}

	@ROKConfigTool:HAS[#Scrubber[Vacuum]]
	{
		CO2 = 
		CO2 *= #$Crew$
		Volume += #$CO2$
	}

	@ROKConfigTool:HAS[#LOXGOX[?rue]]
	{
		Oxygen *= 
		Oxygen *= #$Crew$
	}

	@ROKConfigTool:HAS[~LOXGOX[?rue]]
	{
		Oxygen *= #$Crew$
		Oxygen *= #$Days$
	}

	@ROKConfigTool:HAS[#FUELCELL[?rue]]
	{
		Water *= 
		Water *= #$Crew$
	}

	@ROKConfigTool:HAS[~FUELCELL[?rue]]
	{
		Water *= #$Crew$
		Water *= #$Days$
	}

	@ROKConfigTool
	{
		Food *= #$Crew$
		Food *= #$Days$
		WasteWater = 
		Volume += #$Food$
		Volume += #$Oxygen$
		Volume += #$Water$
		Volume += #$Waste$
	}
}

@PART:HAS[@ROKConfigTool:HAS[~Food[0]]]:LAST
{
	%MODULE[ModuleFuelTanks]
	{
		&volume = 0
		volume += #$/ROKConfigTool/Volume$

		TANK
		{
			name = Food
			amount = #$/ROKConfigTool/Food$
			maxAmount = #$/ROKConfigTool/Food$
		}

		TANK
		{
			name = Oxygen
			amount = #$/ROKConfigTool/Oxygen$
			maxAmount = #$/ROKConfigTool/Oxygen$
		}

		TANK
		{
			name = Water
			amount = #$/ROKConfigTool/Water$
			maxAmount = #$/ROKConfigTool/Water$
		}

		TANK
		{
			name = Waste
			amount = 0
			maxAmount = #$/ROKConfigTool/Waste$
		}

		TANK
		{
			name = WasteWater
			amount = 0
			maxAmount = #$/ROKConfigTool/WasteWater$
		}
	}
}

@PART:HAS[@ROKConfigTool:HAS[#AppendDescription[?rue]]]:LAST
{
	@description = #$description$ Supports a crew of $/ROKConfigTool/Crew$ for $/ROKConfigTool/Days$ days.
}

// Cleanup
@PART:HAS[@ROKConfigTool]:LAST
{
	!ROKConfigTool {}
}